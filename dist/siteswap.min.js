(function(f){if(typeof exports==="object"&&typeof module!=="undefined"){module.exports=f()}else if(typeof define==="function"&&define.amd){define([],f)}else{var g;if(typeof window!=="undefined"){g=window}else if(typeof global!=="undefined"){g=global}else if(typeof self!=="undefined"){g=self}else{g=this}g.Siteswap = f()}})(function(){var define,module,exports;module={exports:(exports={})};
"use strict";function s(s,e){if(!s)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?s:e}function e(s,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);s.prototype=Object.create(e&&e.prototype,{constructor:{value:s,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(s,e):s.__proto__=e)}function a(s,e){if(!(s instanceof e))throw new TypeError("Cannot call a class as a function")}function t(s){if(Array.isArray(s)){for(var e=0,a=Array(s.length);e<s.length;e++)a[e]=s[e];return a}return Array.from(s)}function r(s,e){if(s.length!==e.length)return!1;for(var a=0;a<s.length;a++){var t=s[a],r=e[a];if(t.length!==r.length)return!1;for(var l=0;l<t.length;l++){var n=t[l],o=r[l];if(n.length!==o.length)return!1;for(var $=0;$<n.length;$++){var c=n[$],i=o[$];if(c.value!==i.value||c.handFrom!==i.handFrom||c.handTo!==i.handTo)return!1}}}return!0}function Toss(s,e,a){this.value=s,this.handFrom=e,this.handTo=a}function l(s,e,a,t,r){var n=a[t][r],o=!0,$=!1,c=void 0;try{for(var i,m=n[Symbol.iterator]();!(o=(i=m.next()).done);o=!0){var p=i.value;if(0!==p.value){var u=(t+p.value)%a.length;e[u][p.handTo]!==s&&(e[u][p.handTo]=s,l(s,e,a,u,p.handTo))}}}catch(s){$=!0,c=s}finally{try{!o&&m.return&&m.return()}finally{if($)throw c}}}function n(s,e,a){return this.id=++n.highestId,this.name=s,this.symbols=e,this.postprocess=a,this}function o(s,e,a,t){this.rule=s,this.dot=e,this.reference=a,this.data=[],this.wantedBy=t,this.isComplete=this.dot===s.symbols.length}function $(s,e){this.grammar=s,this.index=e,this.states=[],this.wants={},this.scannable=[],this.completed={}}function c(s,e){this.rules=s,this.start=e||this.rules[0].name;var a=this.byName={};this.rules.forEach(function(s){a.hasOwnProperty(s.name)||(a[s.name]=[]),a[s.name].push(s)})}function i(){this.reset("")}function m(s,e,a){if(s instanceof c)var t=s,a=e;else t=c.fromCompiled(s,e);this.grammar=t,this.options={keepHistory:!1,lexer:t.lexer||new i};for(var r in a||{})this.options[r]=a[r];this.lexer=this.options.lexer,this.lexerState=void 0;var l=new $(t,0);this.table=[l];l.wants[t.start]=[],l.predict(t.start),l.process(),this.current=0}function p(s){return s[0]}function u(s){return s.concat(s.map(function(s){return s.map(function(s){return s.map(function(s){return{value:s.value,crossing:s.crossing}})}).reverse()}))}function f(s){return s.map(function(s){return s.map(function(s,e){return s.map(function(s){return new Toss(s.value,e,s.crossing?1-e:e)})})})}function b(s){return s[0]}function _(s){return s.concat(s.map(function(s){return s.map(function(s){return s.map(function(s){return{value:s.value,crossing:s.crossing}})}).reverse()}))}function h(s){return s.map(function(s){return s.map(function(s,e){return s.map(function(s){return new Toss(s.value,e,s.crossing?1-e:e)})})})}function w(s){return s<"a"?s.charCodeAt(0)-"A".charCodeAt(0)+36:s.charCodeAt(0)-"a".charCodeAt(0)+10}function y(s){return s[0]}function d(s){return s[0]}function v(s){return s<10?s:s<36?String.fromCharCode("a".charCodeAt(0)+s-10):s<62?String.fromCharCode("A".charCodeAt(0)+s-36):void 0}var State=function State(s){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];a(this,State);var t=void 0;if(s instanceof Array)t=s;else{if(!(s instanceof Siteswap))throw new Error("Invalid input.");t=[];for(var r=s,l=0;l<r.degree;l++){for(var n=[],o=0;o<r.greatestValue;o++)n.push(e?[]:0);t.push(n)}for(var $=0,c=-1;$<r.props;c--){var i=r.throws[(c%r.throws.length+r.throws.length)%r.throws.length],m=!0,p=!1,u=void 0;try{for(var f,b=i[Symbol.iterator]();!(m=(f=b.next()).done);m=!0){var _=f.value,h=!0,w=!1,y=void 0;try{for(var d,v=_[Symbol.iterator]();!(h=(d=v.next()).done);h=!0){var g=d.value;c+g.value>=0&&(e?t[g.handTo][c+g.value].push($):t[g.handTo][c+g.value]++,$++)}}catch(s){w=!0,y=s}finally{try{!h&&v.return&&v.return()}finally{if(w)throw y}}}}catch(s){p=!0,u=s}finally{try{!m&&b.return&&b.return()}finally{if(p)throw u}}}}this.schedule=t,this.strict=e,this.ground=!this.isExcited()};State.prototype.advance=function(s){if(0===this.schedule[0].length)return this;var e=[];this.strict?e.push.apply(e,t(this.schedule.map(function(s){return[].concat(t(s.slice(1).map(function(s){return s.slice()})),[[]])}))):e.push.apply(e,t(this.schedule.map(function(s){return[].concat(t(s.slice(1)),[0])})));var a=!0,r=!1,l=void 0;try{for(var n,o=s[Symbol.iterator]();!(a=(n=o.next()).done);a=!0)for(var $=n.value,c=0;c<$.length;c++){var i=$[c];if(i.value>0)if(this.strict){var m=this.schedule[i.handFrom][0][c];e[i.handTo][i.value-1].push(m)}else e[i.handTo][i.value-1]++}}catch(s){r=!0,l=s}finally{try{!a&&o.return&&o.return()}finally{if(r)throw l}}return new State(e,this.strict)},State.prototype.equals=function(s){if(this.strict!==s.strict)return!1;var e=this.schedule,a=s.schedule;if(e.length!==a.length)return!1;for(var t=0;t<e.length;t++){if(e[t].length!==a[t].length)return!1;for(var r=0;r<e[t].length;r++)if(this.strict){if(e[t][r].length!==a[t][r].length)return!1;for(var l=0;l<e[t][r].length;l++)if(e[t][r][l]!==a[t][r][l])return!1}else if(e[t][r]!==a[t][r])return!1}return!0},State.prototype.isExcited=function(){this.schedule;var s=void 0;s=this.strict?this.schedule.reduce(function(s,e){return s+e.reduce(function(s,e){return s+e.length},0)},0):this.schedule.reduce(function(s,e){return s+e.reduce(function(s,e){return s+e},0)},0);var e=this.schedule.length,a=this.schedule[0].length,t=Math.floor(s/e),r=s%e;if(this.strict)for(var l=0;l<e;l++){for(var n=0;n<t;n++)if(1!==this.schedule[l][n].length)return!0;if(t!==a){for(var o=1===this.schedule[l][t].length?1:0,$=t+o;$<a;$++)if(0!==this.schedule[l][$].length)return!0;r-=o}}else for(var c=0;c<e;c++){for(var i=0;i<t;i++)if(1!==this.schedule[c][i])return!0;for(var m=1===this.schedule[c][t]?1:0,p=t+m;p<a;p++)if(0!==this.schedule[c][p])return!0;r-=m}return 0!==r},n.highestId=0,n.prototype.toString=function(s){function e(s){return s.literal?JSON.stringify(s.literal):s.type?"%"+s.type:s.toString()}var a=void 0===s?this.symbols.map(e).join(" "):this.symbols.slice(0,s).map(e).join(" ")+" ● "+this.symbols.slice(s).map(e).join(" ");return this.name+" → "+a},o.prototype.toString=function(){return"{"+this.rule.toString(this.dot)+"}, from: "+(this.reference||0)},o.prototype.nextState=function(s){var e=new o(this.rule,this.dot+1,this.reference,this.wantedBy);return e.left=this,e.right=s,e.isComplete&&(e.data=e.build()),e},o.prototype.build=function(){var s=[],e=this;do{s.push(e.right.data),e=e.left}while(e.left);return s.reverse(),s},o.prototype.finish=function(){this.rule.postprocess&&(this.data=this.rule.postprocess(this.data,this.reference,m.fail))},$.prototype.process=function(s){for(var e=this.states,a=this.wants,t=this.completed,r=0;r<e.length;r++){var l=e[r];if(l.isComplete){if(l.finish(),l.data!==m.fail){for(var n=l.wantedBy,o=n.length;o--;){var $=n[o];this.complete($,l)}if(l.reference===this.index){var c=l.rule.name;(this.completed[c]=this.completed[c]||[]).push(l)}}}else{if("string"!=typeof(c=l.rule.symbols[l.dot])){this.scannable.push(l);continue}if(a[c]){if(a[c].push(l),t.hasOwnProperty(c))for(var i=t[c],o=0;o<i.length;o++){var p=i[o];this.complete(l,p)}}else a[c]=[l],this.predict(c)}}},$.prototype.predict=function(s){for(var e=this.grammar.byName[s]||[],a=0;a<e.length;a++){var t=e[a],r=this.wants[s],l=new o(t,0,this.index,r);this.states.push(l)}},$.prototype.complete=function(s,e){var a=e.rule.name;if(s.rule.symbols[s.dot]===a){var t=s.nextState(e);this.states.push(t)}},c.fromCompiled=function(s,e){var a=s.Lexer;s.ParserStart&&(e=s.ParserStart,s=s.ParserRules);var t=new c(s=s.map(function(s){return new n(s.name,s.symbols,s.postprocess)}),e);return t.lexer=a,t},i.prototype.reset=function(s,e){this.buffer=s,this.index=0,this.line=e?e.line:1,this.lastLineBreak=e?-e.col:0},i.prototype.next=function(){if(this.index<this.buffer.length){var s=this.buffer[this.index++];return"\n"===s&&(this.line+=1,this.lastLineBreak=this.index),{value:s}}},i.prototype.save=function(){return{line:this.line,col:this.index-this.lastLineBreak}},i.prototype.formatError=function(s,e){var a=this.buffer;if("string"==typeof a){var t=a.indexOf("\n",this.index);-1===t&&(t=a.length);var r=a.substring(this.lastLineBreak,t),l=this.index-this.lastLineBreak;return e+=" at line "+this.line+" col "+l+":\n\n",e+="  "+r+"\n",e+="  "+Array(l).join(" ")+"^"}return e+" at index "+(this.index-1)},m.fail={},m.prototype.feed=function(s){var e=this.lexer;e.reset(s,this.lexerState);for(var a;a=e.next();){var t=this.table[this.current];this.options.keepHistory||delete this.table[this.current-1];var r=this.current+1,l=new $(this.grammar,r);this.table.push(l);for(var n=a.value,o=e.constructor===i?a.value:a,c=t.scannable,m=c.length;m--;){var p=c[m],u=p.rule.symbols[p.dot];if(u.test?u.test(o):u.type?u.type===a.type:u.literal===n){var f=p.nextState({data:o,token:a,isToken:!0,reference:r-1});l.states.push(f)}}if(l.process(),0===l.states.length){var b=this.lexer.formatError(a,"invalid syntax")+"\n";b+="Unexpected "+(a.type?a.type+" token: ":""),b+=JSON.stringify(void 0!==a.value?a.value:a)+"\n";var _=new Error(b);throw _.offset=this.current,_.token=a,_}this.options.keepHistory&&(t.lexerState=e.save()),this.current++}return t&&(this.lexerState=e.save()),this.results=this.finish(),this},m.prototype.save=function(){var s=this.table[this.current];return s.lexerState=this.lexerState,s},m.prototype.restore=function(s){var e=s.index;this.current=e,this.table[e]=s,this.table.splice(e+1),this.lexerState=s.lexerState,this.results=this.finish()},m.prototype.rewind=function(s){if(!this.options.keepHistory)throw new Error("set option `keepHistory` to enable rewinding");this.restore(this.table[s])},m.prototype.finish=function(){var s=[],e=this.grammar.start;return this.table[this.table.length-1].states.forEach(function(a){a.rule.name===e&&a.dot===a.rule.symbols.length&&0===a.reference&&a.data!==m.fail&&s.push(a)}),s.map(function(s){return s.data})};var g={standard:{Lexer:void 0,ParserRules:[{name:"siteswap",symbols:["siteswap_a"],postprocess:function(s){return f(s[0])}},{name:"siteswap",symbols:["siteswap_s"],postprocess:function(s){return f(s[0])}},{name:"siteswap_a$macrocall$2$macrocall$2",symbols:[{literal:","}]},{name:"siteswap_a$macrocall$2$macrocall$1$macrocall$2",symbols:["siteswap_a$macrocall$2$macrocall$2"]},{name:"siteswap_a$macrocall$2$macrocall$1$macrocall$1",symbols:["toss_a"]},{name:"siteswap_a$macrocall$2$macrocall$1$macrocall$1$ebnf$1$subexpression$1",symbols:["siteswap_a$macrocall$2$macrocall$1$macrocall$2","toss_a"]},{name:"siteswap_a$macrocall$2$macrocall$1$macrocall$1$ebnf$1",symbols:["siteswap_a$macrocall$2$macrocall$1$macrocall$1$ebnf$1$subexpression$1"]},{name:"siteswap_a$macrocall$2$macrocall$1$macrocall$1$ebnf$1$subexpression$2",symbols:["siteswap_a$macrocall$2$macrocall$1$macrocall$2","toss_a"]},{name:"siteswap_a$macrocall$2$macrocall$1$macrocall$1$ebnf$1",symbols:["siteswap_a$macrocall$2$macrocall$1$macrocall$1$ebnf$1","siteswap_a$macrocall$2$macrocall$1$macrocall$1$ebnf$1$subexpression$2"],postprocess:function(s){return s[0].concat([s[1]])}},{name:"siteswap_a$macrocall$2$macrocall$1$macrocall$1",symbols:[{literal:"["},"toss_a","siteswap_a$macrocall$2$macrocall$1$macrocall$1$ebnf$1",{literal:"]"}],postprocess:function(s){return[s[1]].concat(t(s[2].map(function(s){return s[1]})))}},{name:"siteswap_a$macrocall$2$macrocall$1",symbols:["siteswap_a$macrocall$2$macrocall$1$macrocall$1"]},{name:"siteswap_a$macrocall$2",symbols:["siteswap_a$macrocall$2$macrocall$1"]},{name:"siteswap_a$macrocall$3",symbols:[{literal:","}]},{name:"siteswap_a$macrocall$1$ebnf$1",symbols:[]},{name:"siteswap_a$macrocall$1$ebnf$1$subexpression$1",symbols:["siteswap_a$macrocall$3","siteswap_a$macrocall$2"]},{name:"siteswap_a$macrocall$1$ebnf$1",symbols:["siteswap_a$macrocall$1$ebnf$1","siteswap_a$macrocall$1$ebnf$1$subexpression$1"],postprocess:function(s){return s[0].concat([s[1]])}},{name:"siteswap_a$macrocall$1",symbols:["siteswap_a$macrocall$2","siteswap_a$macrocall$1$ebnf$1"],postprocess:function(s){return[s[0][0]].concat(t(s[1].map(function(s){return s[1][0]})))}},{name:"siteswap_a",symbols:["siteswap_a$macrocall$1"],postprocess:p},{name:"siteswap_a$macrocall$5$macrocall$2",symbols:[{literal:" "}]},{name:"siteswap_a$macrocall$5$macrocall$1$macrocall$2",symbols:["siteswap_a$macrocall$5$macrocall$2"]},{name:"siteswap_a$macrocall$5$macrocall$1$macrocall$1",symbols:["toss_a"]},{name:"siteswap_a$macrocall$5$macrocall$1$macrocall$1$ebnf$1$subexpression$1",symbols:["siteswap_a$macrocall$5$macrocall$1$macrocall$2","toss_a"]},{name:"siteswap_a$macrocall$5$macrocall$1$macrocall$1$ebnf$1",symbols:["siteswap_a$macrocall$5$macrocall$1$macrocall$1$ebnf$1$subexpression$1"]},{name:"siteswap_a$macrocall$5$macrocall$1$macrocall$1$ebnf$1$subexpression$2",symbols:["siteswap_a$macrocall$5$macrocall$1$macrocall$2","toss_a"]},{name:"siteswap_a$macrocall$5$macrocall$1$macrocall$1$ebnf$1",symbols:["siteswap_a$macrocall$5$macrocall$1$macrocall$1$ebnf$1","siteswap_a$macrocall$5$macrocall$1$macrocall$1$ebnf$1$subexpression$2"],postprocess:function(s){return s[0].concat([s[1]])}},{name:"siteswap_a$macrocall$5$macrocall$1$macrocall$1",symbols:[{literal:"["},"toss_a","siteswap_a$macrocall$5$macrocall$1$macrocall$1$ebnf$1",{literal:"]"}],postprocess:function(s){return[s[1]].concat(t(s[2].map(function(s){return s[1]})))}},{name:"siteswap_a$macrocall$5$macrocall$1",symbols:["siteswap_a$macrocall$5$macrocall$1$macrocall$1"]},{name:"siteswap_a$macrocall$5",symbols:["siteswap_a$macrocall$5$macrocall$1"]},{name:"siteswap_a$macrocall$6",symbols:[{literal:" "}]},{name:"siteswap_a$macrocall$4$ebnf$1",symbols:[]},{name:"siteswap_a$macrocall$4$ebnf$1$subexpression$1",symbols:["siteswap_a$macrocall$6","siteswap_a$macrocall$5"]},{name:"siteswap_a$macrocall$4$ebnf$1",symbols:["siteswap_a$macrocall$4$ebnf$1","siteswap_a$macrocall$4$ebnf$1$subexpression$1"],postprocess:function(s){return s[0].concat([s[1]])}},{name:"siteswap_a$macrocall$4",symbols:["siteswap_a$macrocall$5","siteswap_a$macrocall$4$ebnf$1"],postprocess:function(s){return[s[0][0]].concat(t(s[1].map(function(s){return s[1][0]})))}},{name:"siteswap_a",symbols:["siteswap_a$macrocall$4"],postprocess:p},{name:"toss_a",symbols:["digit_a"],postprocess:function(s){return{value:s[0]}}},{name:"digit_a",symbols:[/[0-9]/],postprocess:function(s){return Number(s[0])}},{name:"digit_a$ebnf$1",symbols:[/[0-9]/]},{name:"digit_a$ebnf$1",symbols:["digit_a$ebnf$1",/[0-9]/],postprocess:function(s){return s[0].concat([s[1]])}},{name:"digit_a",symbols:[/[1-9]/,"digit_a$ebnf$1"],postprocess:function(s){return Number([s[0]].concat(t(s[1])).join(""))}},{name:"siteswap_s$ebnf$1$macrocall$2",symbols:[{literal:","}]},{name:"siteswap_s$ebnf$1$macrocall$1$macrocall$2",symbols:["siteswap_s$ebnf$1$macrocall$2"]},{name:"siteswap_s$ebnf$1$macrocall$1$macrocall$1",symbols:["toss_s"]},{name:"siteswap_s$ebnf$1$macrocall$1$macrocall$1$ebnf$1$subexpression$1",symbols:["siteswap_s$ebnf$1$macrocall$1$macrocall$2","toss_s"]},{name:"siteswap_s$ebnf$1$macrocall$1$macrocall$1$ebnf$1",symbols:["siteswap_s$ebnf$1$macrocall$1$macrocall$1$ebnf$1$subexpression$1"]},{name:"siteswap_s$ebnf$1$macrocall$1$macrocall$1$ebnf$1$subexpression$2",symbols:["siteswap_s$ebnf$1$macrocall$1$macrocall$2","toss_s"]},{name:"siteswap_s$ebnf$1$macrocall$1$macrocall$1$ebnf$1",symbols:["siteswap_s$ebnf$1$macrocall$1$macrocall$1$ebnf$1","siteswap_s$ebnf$1$macrocall$1$macrocall$1$ebnf$1$subexpression$2"],postprocess:function(s){return s[0].concat([s[1]])}},{name:"siteswap_s$ebnf$1$macrocall$1$macrocall$1",symbols:[{literal:"["},"toss_s","siteswap_s$ebnf$1$macrocall$1$macrocall$1$ebnf$1",{literal:"]"}],postprocess:function(s){return[s[1]].concat(t(s[2].map(function(s){return s[1]})))}},{name:"siteswap_s$ebnf$1$macrocall$1$macrocall$4",symbols:["siteswap_s$ebnf$1$macrocall$2"]},{name:"siteswap_s$ebnf$1$macrocall$1$macrocall$3",symbols:["toss_s"]},{name:"siteswap_s$ebnf$1$macrocall$1$macrocall$3$ebnf$1$subexpression$1",symbols:["siteswap_s$ebnf$1$macrocall$1$macrocall$4","toss_s"]},{name:"siteswap_s$ebnf$1$macrocall$1$macrocall$3$ebnf$1",symbols:["siteswap_s$ebnf$1$macrocall$1$macrocall$3$ebnf$1$subexpression$1"]},{name:"siteswap_s$ebnf$1$macrocall$1$macrocall$3$ebnf$1$subexpression$2",symbols:["siteswap_s$ebnf$1$macrocall$1$macrocall$4","toss_s"]},{name:"siteswap_s$ebnf$1$macrocall$1$macrocall$3$ebnf$1",symbols:["siteswap_s$ebnf$1$macrocall$1$macrocall$3$ebnf$1","siteswap_s$ebnf$1$macrocall$1$macrocall$3$ebnf$1$subexpression$2"],postprocess:function(s){return s[0].concat([s[1]])}},{name:"siteswap_s$ebnf$1$macrocall$1$macrocall$3",symbols:[{literal:"["},"toss_s","siteswap_s$ebnf$1$macrocall$1$macrocall$3$ebnf$1",{literal:"]"}],postprocess:function(s){return[s[1]].concat(t(s[2].map(function(s){return s[1]})))}},{name:"siteswap_s$ebnf$1$macrocall$1",symbols:[{literal:"("},"siteswap_s$ebnf$1$macrocall$1$macrocall$1","siteswap_s$ebnf$1$macrocall$2","siteswap_s$ebnf$1$macrocall$1$macrocall$3",{literal:")"}],postprocess:function(s){return[s[1],s[3]]}},{name:"siteswap_s$ebnf$1",symbols:["siteswap_s$ebnf$1$macrocall$1"]},{name:"siteswap_s$ebnf$1$macrocall$4",symbols:[{literal:","}]},{name:"siteswap_s$ebnf$1$macrocall$3$macrocall$2",symbols:["siteswap_s$ebnf$1$macrocall$4"]},{name:"siteswap_s$ebnf$1$macrocall$3$macrocall$1",symbols:["toss_s"]},{name:"siteswap_s$ebnf$1$macrocall$3$macrocall$1$ebnf$1$subexpression$1",symbols:["siteswap_s$ebnf$1$macrocall$3$macrocall$2","toss_s"]},{name:"siteswap_s$ebnf$1$macrocall$3$macrocall$1$ebnf$1",symbols:["siteswap_s$ebnf$1$macrocall$3$macrocall$1$ebnf$1$subexpression$1"]},{name:"siteswap_s$ebnf$1$macrocall$3$macrocall$1$ebnf$1$subexpression$2",symbols:["siteswap_s$ebnf$1$macrocall$3$macrocall$2","toss_s"]},{name:"siteswap_s$ebnf$1$macrocall$3$macrocall$1$ebnf$1",symbols:["siteswap_s$ebnf$1$macrocall$3$macrocall$1$ebnf$1","siteswap_s$ebnf$1$macrocall$3$macrocall$1$ebnf$1$subexpression$2"],postprocess:function(s){return s[0].concat([s[1]])}},{name:"siteswap_s$ebnf$1$macrocall$3$macrocall$1",symbols:[{literal:"["},"toss_s","siteswap_s$ebnf$1$macrocall$3$macrocall$1$ebnf$1",{literal:"]"}],postprocess:function(s){return[s[1]].concat(t(s[2].map(function(s){return s[1]})))}},{name:"siteswap_s$ebnf$1$macrocall$3$macrocall$4",symbols:["siteswap_s$ebnf$1$macrocall$4"]},{name:"siteswap_s$ebnf$1$macrocall$3$macrocall$3",symbols:["toss_s"]},{name:"siteswap_s$ebnf$1$macrocall$3$macrocall$3$ebnf$1$subexpression$1",symbols:["siteswap_s$ebnf$1$macrocall$3$macrocall$4","toss_s"]},{name:"siteswap_s$ebnf$1$macrocall$3$macrocall$3$ebnf$1",symbols:["siteswap_s$ebnf$1$macrocall$3$macrocall$3$ebnf$1$subexpression$1"]},{name:"siteswap_s$ebnf$1$macrocall$3$macrocall$3$ebnf$1$subexpression$2",symbols:["siteswap_s$ebnf$1$macrocall$3$macrocall$4","toss_s"]},{name:"siteswap_s$ebnf$1$macrocall$3$macrocall$3$ebnf$1",symbols:["siteswap_s$ebnf$1$macrocall$3$macrocall$3$ebnf$1","siteswap_s$ebnf$1$macrocall$3$macrocall$3$ebnf$1$subexpression$2"],postprocess:function(s){return s[0].concat([s[1]])}},{name:"siteswap_s$ebnf$1$macrocall$3$macrocall$3",symbols:[{literal:"["},"toss_s","siteswap_s$ebnf$1$macrocall$3$macrocall$3$ebnf$1",{literal:"]"}],postprocess:function(s){return[s[1]].concat(t(s[2].map(function(s){return s[1]})))}},{name:"siteswap_s$ebnf$1$macrocall$3",symbols:[{literal:"("},"siteswap_s$ebnf$1$macrocall$3$macrocall$1","siteswap_s$ebnf$1$macrocall$4","siteswap_s$ebnf$1$macrocall$3$macrocall$3",{literal:")"}],postprocess:function(s){return[s[1],s[3]]}},{name:"siteswap_s$ebnf$1",symbols:["siteswap_s$ebnf$1","siteswap_s$ebnf$1$macrocall$3"],postprocess:function(s){return s[0].concat([s[1]])}},{name:"siteswap_s$ebnf$2",symbols:[{literal:"*"}],postprocess:p},{name:"siteswap_s$ebnf$2",symbols:[],postprocess:function(s){return null}},{name:"siteswap_s",symbols:["siteswap_s$ebnf$1","siteswap_s$ebnf$2"],postprocess:function(s){return null===s[1]?s[0]:u(s[0])}},{name:"siteswap_s$ebnf$3$macrocall$2",symbols:[{literal:" "}]},{name:"siteswap_s$ebnf$3$macrocall$1$macrocall$2",symbols:["siteswap_s$ebnf$3$macrocall$2"]},{name:"siteswap_s$ebnf$3$macrocall$1$macrocall$1",symbols:["toss_s"]},{name:"siteswap_s$ebnf$3$macrocall$1$macrocall$1$ebnf$1$subexpression$1",symbols:["siteswap_s$ebnf$3$macrocall$1$macrocall$2","toss_s"]},{name:"siteswap_s$ebnf$3$macrocall$1$macrocall$1$ebnf$1",symbols:["siteswap_s$ebnf$3$macrocall$1$macrocall$1$ebnf$1$subexpression$1"]},{name:"siteswap_s$ebnf$3$macrocall$1$macrocall$1$ebnf$1$subexpression$2",symbols:["siteswap_s$ebnf$3$macrocall$1$macrocall$2","toss_s"]},{name:"siteswap_s$ebnf$3$macrocall$1$macrocall$1$ebnf$1",symbols:["siteswap_s$ebnf$3$macrocall$1$macrocall$1$ebnf$1","siteswap_s$ebnf$3$macrocall$1$macrocall$1$ebnf$1$subexpression$2"],postprocess:function(s){return s[0].concat([s[1]])}},{name:"siteswap_s$ebnf$3$macrocall$1$macrocall$1",symbols:[{literal:"["},"toss_s","siteswap_s$ebnf$3$macrocall$1$macrocall$1$ebnf$1",{literal:"]"}],postprocess:function(s){return[s[1]].concat(t(s[2].map(function(s){return s[1]})))}},{name:"siteswap_s$ebnf$3$macrocall$1$macrocall$4",symbols:["siteswap_s$ebnf$3$macrocall$2"]},{name:"siteswap_s$ebnf$3$macrocall$1$macrocall$3",symbols:["toss_s"]},{name:"siteswap_s$ebnf$3$macrocall$1$macrocall$3$ebnf$1$subexpression$1",symbols:["siteswap_s$ebnf$3$macrocall$1$macrocall$4","toss_s"]},{name:"siteswap_s$ebnf$3$macrocall$1$macrocall$3$ebnf$1",symbols:["siteswap_s$ebnf$3$macrocall$1$macrocall$3$ebnf$1$subexpression$1"]},{name:"siteswap_s$ebnf$3$macrocall$1$macrocall$3$ebnf$1$subexpression$2",symbols:["siteswap_s$ebnf$3$macrocall$1$macrocall$4","toss_s"]},{name:"siteswap_s$ebnf$3$macrocall$1$macrocall$3$ebnf$1",symbols:["siteswap_s$ebnf$3$macrocall$1$macrocall$3$ebnf$1","siteswap_s$ebnf$3$macrocall$1$macrocall$3$ebnf$1$subexpression$2"],postprocess:function(s){return s[0].concat([s[1]])}},{name:"siteswap_s$ebnf$3$macrocall$1$macrocall$3",symbols:[{literal:"["},"toss_s","siteswap_s$ebnf$3$macrocall$1$macrocall$3$ebnf$1",{literal:"]"}],postprocess:function(s){return[s[1]].concat(t(s[2].map(function(s){return s[1]})))}},{name:"siteswap_s$ebnf$3$macrocall$1",symbols:[{literal:"("},"siteswap_s$ebnf$3$macrocall$1$macrocall$1","siteswap_s$ebnf$3$macrocall$2","siteswap_s$ebnf$3$macrocall$1$macrocall$3",{literal:")"}],postprocess:function(s){return[s[1],s[3]]}},{name:"siteswap_s$ebnf$3",symbols:["siteswap_s$ebnf$3$macrocall$1"]},{name:"siteswap_s$ebnf$3$macrocall$4",symbols:[{literal:" "}]},{name:"siteswap_s$ebnf$3$macrocall$3$macrocall$2",symbols:["siteswap_s$ebnf$3$macrocall$4"]},{name:"siteswap_s$ebnf$3$macrocall$3$macrocall$1",symbols:["toss_s"]},{name:"siteswap_s$ebnf$3$macrocall$3$macrocall$1$ebnf$1$subexpression$1",symbols:["siteswap_s$ebnf$3$macrocall$3$macrocall$2","toss_s"]},{name:"siteswap_s$ebnf$3$macrocall$3$macrocall$1$ebnf$1",symbols:["siteswap_s$ebnf$3$macrocall$3$macrocall$1$ebnf$1$subexpression$1"]},{name:"siteswap_s$ebnf$3$macrocall$3$macrocall$1$ebnf$1$subexpression$2",symbols:["siteswap_s$ebnf$3$macrocall$3$macrocall$2","toss_s"]},{name:"siteswap_s$ebnf$3$macrocall$3$macrocall$1$ebnf$1",symbols:["siteswap_s$ebnf$3$macrocall$3$macrocall$1$ebnf$1","siteswap_s$ebnf$3$macrocall$3$macrocall$1$ebnf$1$subexpression$2"],postprocess:function(s){return s[0].concat([s[1]])}},{name:"siteswap_s$ebnf$3$macrocall$3$macrocall$1",symbols:[{literal:"["},"toss_s","siteswap_s$ebnf$3$macrocall$3$macrocall$1$ebnf$1",{literal:"]"}],postprocess:function(s){return[s[1]].concat(t(s[2].map(function(s){return s[1]})))}},{name:"siteswap_s$ebnf$3$macrocall$3$macrocall$4",symbols:["siteswap_s$ebnf$3$macrocall$4"]},{name:"siteswap_s$ebnf$3$macrocall$3$macrocall$3",symbols:["toss_s"]},{name:"siteswap_s$ebnf$3$macrocall$3$macrocall$3$ebnf$1$subexpression$1",symbols:["siteswap_s$ebnf$3$macrocall$3$macrocall$4","toss_s"]},{name:"siteswap_s$ebnf$3$macrocall$3$macrocall$3$ebnf$1",symbols:["siteswap_s$ebnf$3$macrocall$3$macrocall$3$ebnf$1$subexpression$1"]},{name:"siteswap_s$ebnf$3$macrocall$3$macrocall$3$ebnf$1$subexpression$2",symbols:["siteswap_s$ebnf$3$macrocall$3$macrocall$4","toss_s"]},{name:"siteswap_s$ebnf$3$macrocall$3$macrocall$3$ebnf$1",symbols:["siteswap_s$ebnf$3$macrocall$3$macrocall$3$ebnf$1","siteswap_s$ebnf$3$macrocall$3$macrocall$3$ebnf$1$subexpression$2"],postprocess:function(s){return s[0].concat([s[1]])}},{name:"siteswap_s$ebnf$3$macrocall$3$macrocall$3",symbols:[{literal:"["},"toss_s","siteswap_s$ebnf$3$macrocall$3$macrocall$3$ebnf$1",{literal:"]"}],postprocess:function(s){return[s[1]].concat(t(s[2].map(function(s){return s[1]})))}},{name:"siteswap_s$ebnf$3$macrocall$3",symbols:[{literal:"("},"siteswap_s$ebnf$3$macrocall$3$macrocall$1","siteswap_s$ebnf$3$macrocall$4","siteswap_s$ebnf$3$macrocall$3$macrocall$3",{literal:")"}],postprocess:function(s){return[s[1],s[3]]}},{name:"siteswap_s$ebnf$3",symbols:["siteswap_s$ebnf$3","siteswap_s$ebnf$3$macrocall$3"],postprocess:function(s){return s[0].concat([s[1]])}},{name:"siteswap_s$ebnf$4",symbols:[{literal:"*"}],postprocess:p},{name:"siteswap_s$ebnf$4",symbols:[],postprocess:function(s){return null}},{name:"siteswap_s",symbols:["siteswap_s$ebnf$3","siteswap_s$ebnf$4"],postprocess:function(s){return null===s[1]?s[0]:u(s[0])}},{name:"toss_s$ebnf$1",symbols:["crossing"],postprocess:p},{name:"toss_s$ebnf$1",symbols:[],postprocess:function(s){return null}},{name:"toss_s",symbols:["digit_s","toss_s$ebnf$1"],postprocess:function(s){return{value:s[0],crossing:null!==s[1]}}},{name:"digit_s",symbols:[/[02468]/],postprocess:function(s){return Number(s[0])/2}},{name:"digit_s$ebnf$1",symbols:[/[02468]/]},{name:"digit_s$ebnf$1",symbols:["digit_s$ebnf$1",/[02468]/],postprocess:function(s){return s[0].concat([s[1]])}},{name:"digit_s",symbols:[/[2468]/,"digit_s$ebnf$1"],postprocess:function(s){return Number([s[0]].concat(t(s[1])).join(""))/2}},{name:"crossing",symbols:[{literal:"x"}],postprocess:p}],ParserStart:"siteswap"},compressed:{Lexer:void 0,ParserRules:[{name:"siteswap",symbols:["siteswap_a"],postprocess:function(s){return h(s[0])}},{name:"siteswap",symbols:["siteswap_s"],postprocess:function(s){return h(s[0])}},{name:"siteswap_a$ebnf$1",symbols:["action_a"]},{name:"siteswap_a$ebnf$1",symbols:["siteswap_a$ebnf$1","action_a"],postprocess:function(s){return s[0].concat([s[1]])}},{name:"siteswap_a",symbols:["siteswap_a$ebnf$1"],postprocess:b},{name:"action_a",symbols:["release_a"]},{name:"release_a",symbols:["toss_a"]},{name:"release_a$ebnf$1",symbols:["toss_a"]},{name:"release_a$ebnf$1",symbols:["release_a$ebnf$1","toss_a"],postprocess:function(s){return s[0].concat([s[1]])}},{name:"release_a",symbols:[{literal:"["},"toss_a","release_a$ebnf$1",{literal:"]"}],postprocess:function(s){return[s[1]].concat(t(s[2]))}},{name:"toss_a",symbols:["digit_a"],postprocess:function(s){return{value:s[0]}}},{name:"toss_a",symbols:["letter_a"],postprocess:function(s){return{value:s[0]}}},{name:"digit_a",symbols:[/[0-9]/],postprocess:function(s){return Number(s[0])}},{name:"letter_a",symbols:[/[a-zA-Z]/],postprocess:function(s){return w(s[0])}},{name:"siteswap_s$ebnf$1$macrocall$2",symbols:[{literal:","}]},{name:"siteswap_s$ebnf$1$macrocall$1",symbols:[{literal:"("},"release_s","siteswap_s$ebnf$1$macrocall$2","release_s",{literal:")"}],postprocess:function(s){return[s[1],s[3]]}},{name:"siteswap_s$ebnf$1",symbols:["siteswap_s$ebnf$1$macrocall$1"]},{name:"siteswap_s$ebnf$1$macrocall$4",symbols:[{literal:","}]},{name:"siteswap_s$ebnf$1$macrocall$3",symbols:[{literal:"("},"release_s","siteswap_s$ebnf$1$macrocall$4","release_s",{literal:")"}],postprocess:function(s){return[s[1],s[3]]}},{name:"siteswap_s$ebnf$1",symbols:["siteswap_s$ebnf$1","siteswap_s$ebnf$1$macrocall$3"],postprocess:function(s){return s[0].concat([s[1]])}},{name:"siteswap_s$ebnf$2",symbols:[{literal:"*"}],postprocess:b},{name:"siteswap_s$ebnf$2",symbols:[],postprocess:function(s){return null}},{name:"siteswap_s",symbols:["siteswap_s$ebnf$1","siteswap_s$ebnf$2"],postprocess:function(s){return null===s[1]?s[0]:_(s[0])}},{name:"siteswap_s$ebnf$3$macrocall$2",symbols:[]},{name:"siteswap_s$ebnf$3$macrocall$1",symbols:[{literal:"("},"release_s","siteswap_s$ebnf$3$macrocall$2","release_s",{literal:")"}],postprocess:function(s){return[s[1],s[3]]}},{name:"siteswap_s$ebnf$3",symbols:["siteswap_s$ebnf$3$macrocall$1"]},{name:"siteswap_s$ebnf$3$macrocall$4",symbols:[]},{name:"siteswap_s$ebnf$3$macrocall$3",symbols:[{literal:"("},"release_s","siteswap_s$ebnf$3$macrocall$4","release_s",{literal:")"}],postprocess:function(s){return[s[1],s[3]]}},{name:"siteswap_s$ebnf$3",symbols:["siteswap_s$ebnf$3","siteswap_s$ebnf$3$macrocall$3"],postprocess:function(s){return s[0].concat([s[1]])}},{name:"siteswap_s$ebnf$4",symbols:[{literal:"*"}],postprocess:b},{name:"siteswap_s$ebnf$4",symbols:[],postprocess:function(s){return null}},{name:"siteswap_s",symbols:["siteswap_s$ebnf$3","siteswap_s$ebnf$4"],postprocess:function(s){return null===s[1]?s[0]:_(s[0])}},{name:"release_s",symbols:["toss_s"]},{name:"release_s$ebnf$1",symbols:["toss_s"]},{name:"release_s$ebnf$1",symbols:["release_s$ebnf$1","toss_s"],postprocess:function(s){return s[0].concat([s[1]])}},{name:"release_s",symbols:[{literal:"["},"toss_s","release_s$ebnf$1",{literal:"]"}],postprocess:function(s){return[s[1]].concat(t(s[2]))}},{name:"toss_s$ebnf$1",symbols:["crossing"],postprocess:b},{name:"toss_s$ebnf$1",symbols:[],postprocess:function(s){return null}},{name:"toss_s",symbols:["digit_s","toss_s$ebnf$1"],postprocess:function(s){return{value:s[0],crossing:null!==s[1]}}},{name:"toss_s$ebnf$2",symbols:["crossing"],postprocess:b},{name:"toss_s$ebnf$2",symbols:[],postprocess:function(s){return null}},{name:"toss_s",symbols:["letter_s","toss_s$ebnf$2"],postprocess:function(s){return{value:s[0],crossing:null!==s[1]}}},{name:"digit_s",symbols:[/[02468]/],postprocess:function(s){return Number(s[0])/2}},{name:"letter_s",symbols:[/[acegikmoqsuwyACEGIKMOQSUWY]/],postprocess:function(s){return w(s[0])/2}},{name:"crossing",symbols:[{literal:"x"}],postprocess:b}],ParserStart:"siteswap"}},x={standard:{Lexer:void 0,ParserRules:[{name:"siteswap",symbols:["siteswap_a"],postprocess:y},{name:"siteswap",symbols:["siteswap_s"],postprocess:y},{name:"siteswap_a$macrocall$2",symbols:["action_a"]},{name:"siteswap_a$macrocall$1$ebnf$1",symbols:[]},{name:"siteswap_a$macrocall$1$ebnf$1$subexpression$1",symbols:[{literal:","},"siteswap_a$macrocall$2"]},{name:"siteswap_a$macrocall$1$ebnf$1",symbols:["siteswap_a$macrocall$1$ebnf$1","siteswap_a$macrocall$1$ebnf$1$subexpression$1"],postprocess:function(s){return s[0].concat([s[1]])}},{name:"siteswap_a$macrocall$1",symbols:[{literal:"["},"siteswap_a$macrocall$2","siteswap_a$macrocall$1$ebnf$1",{literal:"]"}],postprocess:function(s){return[s[1][0]].concat(t(s[2].map(function(s){return s[1][0]})))}},{name:"siteswap_a",symbols:["siteswap_a$macrocall$1"],postprocess:function(s){return s[0].join(",")}},{name:"siteswap_s$macrocall$2",symbols:["action_s"]},{name:"siteswap_s$macrocall$1$ebnf$1",symbols:[]},{name:"siteswap_s$macrocall$1$ebnf$1$subexpression$1",symbols:[{literal:","},"siteswap_s$macrocall$2"]},{name:"siteswap_s$macrocall$1$ebnf$1",symbols:["siteswap_s$macrocall$1$ebnf$1","siteswap_s$macrocall$1$ebnf$1$subexpression$1"],postprocess:function(s){return s[0].concat([s[1]])}},{name:"siteswap_s$macrocall$1",symbols:[{literal:"["},"siteswap_s$macrocall$2","siteswap_s$macrocall$1$ebnf$1",{literal:"]"}],postprocess:function(s){return[s[1][0]].concat(t(s[2].map(function(s){return s[1][0]})))}},{name:"siteswap_s",symbols:["siteswap_s$macrocall$1"],postprocess:function(s){return s[0].join("")}},{name:"action_a",symbols:[{literal:"["},"release_a",{literal:"]"}],postprocess:function(s){return s[1]}},{name:"action_s",symbols:[{literal:"["},"release_s",{literal:","},"release_s",{literal:"]"}],postprocess:function(s){return"("+s[1]+","+s[3]+")"}},{name:"release_a$macrocall$2",symbols:["toss_a"]},{name:"release_a$macrocall$1$ebnf$1",symbols:[]},{name:"release_a$macrocall$1$ebnf$1$subexpression$1",symbols:[{literal:","},"release_a$macrocall$2"]},{name:"release_a$macrocall$1$ebnf$1",symbols:["release_a$macrocall$1$ebnf$1","release_a$macrocall$1$ebnf$1$subexpression$1"],postprocess:function(s){return s[0].concat([s[1]])}},{name:"release_a$macrocall$1",symbols:[{literal:"["},"release_a$macrocall$2","release_a$macrocall$1$ebnf$1",{literal:"]"}],postprocess:function(s){return[s[1][0]].concat(t(s[2].map(function(s){return s[1][0]})))}},{name:"release_a",symbols:["release_a$macrocall$1"],postprocess:function(s){return s[0].length>1?"["+s[0].join(",")+"]":s[0][0]}},{name:"release_s$macrocall$2",symbols:["toss_s"]},{name:"release_s$macrocall$1$ebnf$1",symbols:[]},{name:"release_s$macrocall$1$ebnf$1$subexpression$1",symbols:[{literal:","},"release_s$macrocall$2"]},{name:"release_s$macrocall$1$ebnf$1",symbols:["release_s$macrocall$1$ebnf$1","release_s$macrocall$1$ebnf$1$subexpression$1"],postprocess:function(s){return s[0].concat([s[1]])}},{name:"release_s$macrocall$1",symbols:[{literal:"["},"release_s$macrocall$2","release_s$macrocall$1$ebnf$1",{literal:"]"}],postprocess:function(s){return[s[1][0]].concat(t(s[2].map(function(s){return s[1][0]})))}},{name:"release_s",symbols:["release_s$macrocall$1"],postprocess:function(s){return s[0].length>1?"["+s[0].join(",")+"]":s[0][0]}},{name:"toss_a$string$1",symbols:[{literal:"{"},{literal:'"'},{literal:"v"},{literal:"a"},{literal:"l"},{literal:"u"},{literal:"e"},{literal:'"'},{literal:":"}],postprocess:function(s){return s.join("")}},{name:"toss_a$string$2",symbols:[{literal:","},{literal:'"'},{literal:"h"},{literal:"a"},{literal:"n"},{literal:"d"},{literal:"F"},{literal:"r"},{literal:"o"},{literal:"m"},{literal:'"'},{literal:":"}],postprocess:function(s){return s.join("")}},{name:"toss_a$string$3",symbols:[{literal:","},{literal:'"'},{literal:"h"},{literal:"a"},{literal:"n"},{literal:"d"},{literal:"T"},{literal:"o"},{literal:'"'},{literal:":"}],postprocess:function(s){return s.join("")}},{name:"toss_a",symbols:["toss_a$string$1","value","toss_a$string$2","hand_a","toss_a$string$3","hand_a",{literal:"}"}],postprocess:function(s){return s[1]}},{name:"toss_s$string$1",symbols:[{literal:"{"},{literal:'"'},{literal:"v"},{literal:"a"},{literal:"l"},{literal:"u"},{literal:"e"},{literal:'"'},{literal:":"}],postprocess:function(s){return s.join("")}},{name:"toss_s$string$2",symbols:[{literal:","},{literal:'"'},{literal:"h"},{literal:"a"},{literal:"n"},{literal:"d"},{literal:"F"},{literal:"r"},{literal:"o"},{literal:"m"},{literal:'"'},{literal:":"}],postprocess:function(s){return s.join("")}},{name:"toss_s$string$3",symbols:[{literal:","},{literal:'"'},{literal:"h"},{literal:"a"},{literal:"n"},{literal:"d"},{literal:"T"},{literal:"o"},{literal:'"'},{literal:":"}],postprocess:function(s){return s.join("")}},{name:"toss_s",symbols:["toss_s$string$1","value","toss_s$string$2","hand_s","toss_s$string$3","hand_s",{literal:"}"}],postprocess:function(s){return 2*s[1]+(s[3]!==s[5]?"x":"")}},{name:"hand_a",symbols:[/[0]/],postprocess:y},{name:"hand_a$string$1",symbols:[{literal:"n"},{literal:"u"},{literal:"l"},{literal:"l"}],postprocess:function(s){return s.join("")}},{name:"hand_a",symbols:["hand_a$string$1"],postprocess:y},{name:"hand_s",symbols:[/[0-1]/],postprocess:y},{name:"hand_s$string$1",symbols:[{literal:"n"},{literal:"u"},{literal:"l"},{literal:"l"}],postprocess:function(s){return s.join("")}},{name:"hand_s",symbols:["hand_s$string$1"],postprocess:y},{name:"value",symbols:[/[0-9]/],postprocess:function(s){return Number(s[0])}},{name:"value$ebnf$1",symbols:[/[0-9]/]},{name:"value$ebnf$1",symbols:["value$ebnf$1",/[0-9]/],postprocess:function(s){return s[0].concat([s[1]])}},{name:"value",symbols:[/[1-9]/,"value$ebnf$1"],postprocess:function(s){return Number(s[0]+s[1].join(""))}}],ParserStart:"siteswap"},compressed:{Lexer:void 0,ParserRules:[{name:"siteswap",symbols:["siteswap_a"],postprocess:d},{name:"siteswap",symbols:["siteswap_s"],postprocess:d},{name:"siteswap_a$macrocall$2",symbols:["action_a"]},{name:"siteswap_a$macrocall$1$ebnf$1",symbols:[]},{name:"siteswap_a$macrocall$1$ebnf$1$subexpression$1",symbols:[{literal:","},"siteswap_a$macrocall$2"]},{name:"siteswap_a$macrocall$1$ebnf$1",symbols:["siteswap_a$macrocall$1$ebnf$1","siteswap_a$macrocall$1$ebnf$1$subexpression$1"],postprocess:function(s){return s[0].concat([s[1]])}},{name:"siteswap_a$macrocall$1",symbols:[{literal:"["},"siteswap_a$macrocall$2","siteswap_a$macrocall$1$ebnf$1",{literal:"]"}],postprocess:function(s){return[s[1][0]].concat(t(s[2].map(function(s){return s[1][0]})))}},{name:"siteswap_a",symbols:["siteswap_a$macrocall$1"],postprocess:function(s){return s[0].join("")}},{name:"siteswap_s$macrocall$2",symbols:["action_s"]},{name:"siteswap_s$macrocall$1$ebnf$1",symbols:[]},{name:"siteswap_s$macrocall$1$ebnf$1$subexpression$1",symbols:[{literal:","},"siteswap_s$macrocall$2"]},{name:"siteswap_s$macrocall$1$ebnf$1",symbols:["siteswap_s$macrocall$1$ebnf$1","siteswap_s$macrocall$1$ebnf$1$subexpression$1"],postprocess:function(s){return s[0].concat([s[1]])}},{name:"siteswap_s$macrocall$1",symbols:[{literal:"["},"siteswap_s$macrocall$2","siteswap_s$macrocall$1$ebnf$1",{literal:"]"}],postprocess:function(s){return[s[1][0]].concat(t(s[2].map(function(s){return s[1][0]})))}},{name:"siteswap_s",symbols:["siteswap_s$macrocall$1"],postprocess:function(s){return s[0].join("")}},{name:"action_a",symbols:[{literal:"["},"release_a",{literal:"]"}],postprocess:function(s){return s[1]}},{name:"action_s",symbols:[{literal:"["},"release_s",{literal:","},"release_s",{literal:"]"}],postprocess:function(s){return"("+s[1]+","+s[3]+")"}},{name:"release_a$macrocall$2",symbols:["toss_a"]},{name:"release_a$macrocall$1$ebnf$1",symbols:[]},{name:"release_a$macrocall$1$ebnf$1$subexpression$1",symbols:[{literal:","},"release_a$macrocall$2"]},{name:"release_a$macrocall$1$ebnf$1",symbols:["release_a$macrocall$1$ebnf$1","release_a$macrocall$1$ebnf$1$subexpression$1"],postprocess:function(s){return s[0].concat([s[1]])}},{name:"release_a$macrocall$1",symbols:[{literal:"["},"release_a$macrocall$2","release_a$macrocall$1$ebnf$1",{literal:"]"}],postprocess:function(s){return[s[1][0]].concat(t(s[2].map(function(s){return s[1][0]})))}},{name:"release_a",symbols:["release_a$macrocall$1"],postprocess:function(s){return s[0].length>1?"["+s[0].join("")+"]":s[0][0]}},{name:"release_s$macrocall$2",symbols:["toss_s"]},{name:"release_s$macrocall$1$ebnf$1",symbols:[]},{name:"release_s$macrocall$1$ebnf$1$subexpression$1",symbols:[{literal:","},"release_s$macrocall$2"]},{name:"release_s$macrocall$1$ebnf$1",symbols:["release_s$macrocall$1$ebnf$1","release_s$macrocall$1$ebnf$1$subexpression$1"],postprocess:function(s){return s[0].concat([s[1]])}},{name:"release_s$macrocall$1",symbols:[{literal:"["},"release_s$macrocall$2","release_s$macrocall$1$ebnf$1",{literal:"]"}],postprocess:function(s){return[s[1][0]].concat(t(s[2].map(function(s){return s[1][0]})))}},{name:"release_s",symbols:["release_s$macrocall$1"],postprocess:function(s){return s[0].length>1?"["+s[0].join("")+"]":s[0][0]}},{name:"toss_a$string$1",symbols:[{literal:"{"},{literal:'"'},{literal:"v"},{literal:"a"},{literal:"l"},{literal:"u"},{literal:"e"},{literal:'"'},{literal:":"}],postprocess:function(s){return s.join("")}},{name:"toss_a$string$2",symbols:[{literal:","},{literal:'"'},{literal:"h"},{literal:"a"},{literal:"n"},{literal:"d"},{literal:"F"},{literal:"r"},{literal:"o"},{literal:"m"},{literal:'"'},{literal:":"}],postprocess:function(s){return s.join("")}},{name:"toss_a$string$3",symbols:[{literal:","},{literal:'"'},{literal:"h"},{literal:"a"},{literal:"n"},{literal:"d"},{literal:"T"},{literal:"o"},{literal:'"'},{literal:":"}],postprocess:function(s){return s.join("")}},{name:"toss_a",symbols:["toss_a$string$1","value","toss_a$string$2","hand_a","toss_a$string$3","hand_a",{literal:"}"}],postprocess:function(s){return v(s[1])}},{name:"toss_s$string$1",symbols:[{literal:"{"},{literal:'"'},{literal:"v"},{literal:"a"},{literal:"l"},{literal:"u"},{literal:"e"},{literal:'"'},{literal:":"}],postprocess:function(s){return s.join("")}},{name:"toss_s$string$2",symbols:[{literal:","},{literal:'"'},{literal:"h"},{literal:"a"},{literal:"n"},{literal:"d"},{literal:"F"},{literal:"r"},{literal:"o"},{literal:"m"},{literal:'"'},{literal:":"}],postprocess:function(s){return s.join("")}},{name:"toss_s$string$3",symbols:[{literal:","},{literal:'"'},{literal:"h"},{literal:"a"},{literal:"n"},{literal:"d"},{literal:"T"},{literal:"o"},{literal:'"'},{literal:":"}],postprocess:function(s){return s.join("")}},{name:"toss_s",symbols:["toss_s$string$1","value","toss_s$string$2","hand_s","toss_s$string$3","hand_s",{literal:"}"}],postprocess:function(s){return v(2*s[1])+(s[3]!==s[5]?"x":"")}},{name:"hand_a",symbols:[/[0]/],postprocess:d},{name:"hand_a$string$1",symbols:[{literal:"n"},{literal:"u"},{literal:"l"},{literal:"l"}],postprocess:function(s){return s.join("")}},{name:"hand_a",symbols:["hand_a$string$1"],postprocess:d},{name:"hand_s",symbols:[/[0-1]/],postprocess:d},{name:"hand_s$string$1",symbols:[{literal:"n"},{literal:"u"},{literal:"l"},{literal:"l"}],postprocess:function(s){return s.join("")}},{name:"hand_s",symbols:["hand_s$string$1"],postprocess:d},{name:"value",symbols:[/[0-9]/],postprocess:function(s){return Number(s[0])}},{name:"value$ebnf$1",symbols:[/[0-9]/]},{name:"value$ebnf$1",symbols:["value$ebnf$1",/[0-9]/],postprocess:function(s){return s[0].concat([s[1]])}},{name:"value",symbols:[/[1-9]/,"value$ebnf$1"],postprocess:function(s){return Number(s[0]+s[1].join(""))}}],ParserStart:"siteswap"}},Juggle=function Juggle(s){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"compressed";a(this,Juggle),this.input=s,this.notation=e;try{var r="string"==typeof s?this.parse(s,e):s;this.validateThrows(r);var l=r.reduce(function(s,e){return Array.prototype.concat.apply(s,e.map(function(s){return s.map(function(s){return s.value})}))},[]);this.throws=r,this.valid=!0,this.degree=r[0].length,this.props=l.reduce(function(s,e){return s+e},0)/r.length,this.multiplex=r.reduce(function(s,e){return Math.max.apply(null,[s].concat(t(e.map(function(s){return s.length}))))},0),this.greatestValue=Math.max.apply(null,l)}catch(s){this.valid=!1,this.message=s.message}};Juggle.prototype.parse=function(s,e){var a=g[e];if(!a)throw new Error("Unsupported notation.");var t=new m(a.ParserRules,a.parserStart).feed(s).results;if(!t.length)throw new Error("Invalid syntax.");return t[0]},Juggle.prototype.validateThrows=function(s){if(!Array.isArray(s)||!s.length)throw new Error("Invalid input.");var e=!0,a=!1,t=void 0;try{for(var r,l=s[Symbol.iterator]();!(e=(r=l.next()).done);e=!0){var n=r.value;if(!Array.isArray(n)||n.length!==s[0].length)throw new Error("Invalid throw sequence.");if(n.some(function(s){return!Array.isArray(s)||!s.every(function(s){return s instanceof Toss})}))throw new Error("Invalid throw sequence.")}}catch(s){a=!0,t=s}finally{try{!e&&l.return&&l.return()}finally{if(a)throw t}}},Juggle.prototype.toString=function(){var s=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.notation;if(!this.valid)throw new Error("Can't call `.toString` on an invalid siteswap.");var e=x[s];if(!e)throw new Error("Unsupported notation.");var a=new m(e.ParserRules,e.parserStart),t=JSON.stringify(this.throws);return a.feed(t).results[0]};var Transition=function(t){function Transition(e,t,r,l){var n;a(this,Transition);var o=s(this,(Transition.__proto__||Object.getPrototypeOf(Transition)).call(this,e,t));return o.valid?(o.stateFrom=r,o.stateTo=l,o):(n=o,s(o,n))}return e(Transition,Juggle),Transition}(),Siteswap=function(t){function Siteswap(e,t){var r;a(this,Siteswap);var l=s(this,(Siteswap.__proto__||Object.getPrototypeOf(Siteswap)).call(this,e,t));if(!l.valid)return r=l,s(l,r);try{l.validate(l.throws),l.valid=!0}catch(e){var n,o=Object.keys(l).filter(function(s){return"input"!==s}),$=!0,c=!1,i=void 0;try{for(var m,p=o[Symbol.iterator]();!($=(m=p.next()).done);$=!0){var u=m.value;delete l[u]}}catch(s){c=!0,i=s}finally{try{!$&&p.return&&p.return()}finally{if(c)throw i}}return l.valid=!1,l.message=e.message,n=l,s(l,n)}return l.truncate(l.throws),l.states=l.schedulise(l.throws,!1),l.strictStates=l.schedulise(l.throws,!0),l.orbits=l.orbitise(l.throws,l.notation),l.composition=l.decompose(l.states,l.throws,l.notation),l.period=l.states.length,l.fullPeriod=l.strictStates.length,l.prime=1===l.composition.length,l.groundState=l.excitify(),l}return e(Siteswap,Juggle),Siteswap}();Siteswap.prototype.validate=function(s){for(var e=s.map(function(s){return s.map(function(s){return 0})}),a=0;a<s.length;a++){var t=s[a],r=!0,l=!1,n=void 0;try{for(var o,$=t[Symbol.iterator]();!(r=(o=$.next()).done);r=!0){var c=o.value,i=!0,m=!1,p=void 0;try{for(var u,f=c[Symbol.iterator]();!(i=(u=f.next()).done);i=!0){var b=u.value;e[a][b.handFrom]++,e[(a+b.value)%s.length][b.handTo]--}}catch(s){m=!0,p=s}finally{try{!i&&f.return&&f.return()}finally{if(m)throw p}}}}catch(s){l=!0,n=s}finally{try{!r&&$.return&&$.return()}finally{if(l)throw n}}}if(e.some(function(s){return s.some(function(s){return 0!==s})}))throw new Error("Invalid siteswap.")},Siteswap.prototype.truncate=function(s){for(var e=1,a=Math.floor(s.length/2);e<=a;e++)if(s.length%e==0)for(var t=s.slice(0,e),l=e;l<s.length&&r(t,s.slice(l,l+e));l+=e)if(e+l===s.length)return s.length=e,s},Siteswap.prototype.schedulise=function(s,e){var a=[new State(this,e)];do{var t=!0,r=!1,l=void 0;try{for(var n,o=s[Symbol.iterator]();!(t=(n=o.next()).done);t=!0){var $=n.value;a.push(a[a.length-1].advance($))}}catch(s){r=!0,l=s}finally{try{!t&&o.return&&o.return()}finally{if(r)throw l}}}while(!a[0].equals(a[a.length-1]));return a.pop(),a},Siteswap.prototype.excitify=function(){return this.states.some(function(s){return s.ground})},Siteswap.prototype.orbitise=function(s,e){for(var a=[],t=s.map(function(s){return s.map(function(s){return null})}),r=0;r<s.length;r++)for(var n=s[r],o=0;o<n.length;o++){var $=n[o];if(null===t[r][o]&&(1!==$.length||0!==$[0].value)){var c=[];l(c,t,s,r,o),a.push(c)}}if(1===a.length)return[this];for(var i=0;i<s.length;i++)!function(e){var r=s[e],l=!0,n=!1,o=void 0;try{for(var $,c=a[Symbol.iterator]();!(l=($=c.next()).done);l=!0)!function(s){s.push(r.map(function(a,r){return t[e][r]===s?a:[new Toss(0,null,null)]}))}($.value)}catch(s){n=!0,o=s}finally{try{!l&&c.return&&c.return()}finally{if(n)throw o}}}(i);return a.map(function(s){return new Siteswap(s,e)})},Siteswap.prototype.decompose=function(s,e,a){for(var t=[],r=0,l=1;l<=s.length;l++)for(var n=l-1;n>=r;n--)if(s[l%s.length].equals(s[n])){if(0===n&&l===s.length)return[this];n>r&&t.push(new Transition(e.slice(r,n),a,s[r],s[n])),t.push(new Siteswap(e.slice(n,l),a)),r=l;break}return r!==s.length&&t.push(new Transition(e.slice(r),a)),t},Siteswap.prototype.log=function(){var s=this;if(this.valid)if(this.degree>2)console.log("No supported notation supports more than two hands.");else{var e=["l","r"],a=[];a.push("siteswap\n "+this.toString()),a.push("props\n "+this.props),a.push("hands\n "+this.degree),a.push("period\n "+this.period),a.push("full period\n "+this.fullPeriod),a.push("multiplex\n "+this.multiplex),a.push("prime\n "+this.prime),a.push("ground state\n "+this.groundState),a.push("throw sequence"),this.throws.forEach(function(t,r){return t.forEach(function(t,l){return a.push(" "+(r+1)+(1===s.degree?"":"-"+e[l])+": ["+t.map(function(a){return a.value+(0===a.value||1===s.degree?"":e[a.handTo])}).join(",")+"]")})}),a.push("states"),this.states.forEach(function(t,r){return t.schedule.forEach(function(t,l){return a.push(" "+(r+1)+(1===s.degree?"":"-"+e[l])+": ["+t.join(",")+"]")})}),a.push("strict states"),this.strictStates.forEach(function(t,r){return t.schedule.forEach(function(t,l){return a.push(" "+(r+1)+(1===s.degree?"":"-"+e[l])+": ["+t.map(function(s){return"["+(s.length?s.join(","):"-")+"]"}).join(",")+"]")})}),a.push("orbits"),this.orbits.forEach(function(s,e){return a.push(" "+(e+1)+": "+s.toString())}),a.push("composition"),this.composition.forEach(function(s,e){return a.push((s instanceof Siteswap?" siteswap: ":" transition: ")+s.toString())}),a.push(" "),console.log(a.join("\n"))}else console.log("Invalid siteswap.")},module.exports=Siteswap;
return module.exports;});